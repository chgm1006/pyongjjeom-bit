<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pyongjjeom.postandreply.dao.PostAndReplyMapper">

	<!-- <select id="getPost" parameterMap="postMap" resultType="Post"> </select> <select 
		id="getReply" parameterMap="postMap" resultType="Post"></select> <update id="updatePost" 
		parameterMap="postMap"> </update> <update id="deletePost" parameterMap="postMap"> 
		</update> -->

	<insert id="insertPost" parameterType="Post">
		INSERT INTO posting
		(postcd,pmemcd,concd,memgrade,comment,deleteyn,spoilyn,regidate,updatedate)
		values
		(#{postCD},#{pmemCD},#{conCD},#{memGrade},#{comment},#{deleteYn},#{spoilYn},now(),now())

	</insert>
<select id="getPost" parameterType="String" resultType="PostAndContents"> 
    select posting.postcd,posting.pmemCD,posting.concd,posting.memgrade,posting.comment,contents.title,contents.director,contents.image,contents.link,contents.actor from posting,contents where posting.pmemcd=#{memCD} and ifnull(posting.deleteyn,'N')='N' and contents.concd=posting.concd order by  updatedate desc;
    </select>
    

	<select id="updatePost" parameterType="String" resultType="Post">

		select * from
		posting where postcd=#{postCD};

	</select> 
	
	<update id="editPost" parameterType="Post">
		update posting
		set memgrade=#{memGrade},comment=#{comment}, 
		review=#{review},updatedate=now()
		where postcd=#{postCD} 

	</update>
	
	<update id="deletePost" parameterType="String">
		update posting
		set deleteyn = 'Y'
		where postcd= #{postCD};
	</update>
	
	
	
</mapper>

